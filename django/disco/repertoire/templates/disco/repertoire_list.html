<!-- templates/disco/repertoire_list.html -->
{% extends 'base.html' %}

{% block title %}–†–µ–ø–µ—Ä—Ç—É–∞—Ä - –î–∏—Å–∫–æ—Ç–µ–∫–∞{% endblock %}

{% block content %}
<h1>üìã –†–µ–ø–µ—Ä—Ç—É–∞—Ä –¥–∏—Å–∫–æ—Ç–µ–∫–∏</h1>

<div class="search-form">
    <form method="get">
        <div style="display: grid; grid-template-columns: 1fr 1fr auto; gap: 1rem; align-items: end;">
            <div class="form-group">
                <label for="id_date">–î–∞—Ç–∞:</label>
                <input type="date" name="date" id="id_date" value="{{ request.GET.date }}">
            </div>
            <div class="form-group">
                <label for="id_day">–î–µ–Ω—å –Ω–µ–¥–µ–ª–∏:</label>
                <select name="day" id="id_day">
                    <option value="">–í—Å–µ –¥–Ω–∏</option>
                    {% for day in days %}
                    <option value="{{ day.id }}" {% if request.GET.day == day.id|stringformat:"i" %}selected{% endif %}>
                        {{ day.name }}
                    </option>
                    {% endfor %}
                </select>
            </div>
            <div>
                <button type="submit" class="btn">üîç –ü–æ–∏—Å–∫</button>
                <a href="{% url 'repertoire:repertoire_list' %}" class="btn">üîÑ –°–±—Ä–æ—Å–∏—Ç—å</a>
            </div>
        </div>
    </form>
</div>

{% if repertoire %}
    <table>
        <thead>
            <tr>
                <th>–î–∞—Ç–∞</th>
                <th>–î–µ–Ω—å</th>
                <th>–í—Ä–µ–º—è</th>
                <th>–ó–∞–ª</th>
                <th>–í–µ–¥—É—â–∏–π</th>
                <th>–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–π —Ç—Ä–µ–∫</th>
                <th>–ñ–∞–Ω—Ä</th>
            </tr>
        </thead>
        <tbody>
            {% for item in repertoire %}
            <tr>
                <td><strong>{{ item.date }}</strong></td>
                <td>{{ item.day }}</td>
                <td>{{ item.start_time|time:"H:i" }} - {{ item.end_time|time:"H:i" }}</td>
                <td>{{ item.hall }}</td>
                <td>{{ item.host }}</td>
                <td>
                    <strong>{{ item.music_track.artist }}</strong><br>
                    {{ item.music_track.title }}
                </td>
                <td>{{ item.music_track.genre }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
    {% if is_paginated %}
    <div style="text-align: center; margin-top: 2rem;">
        {% if page_obj.has_previous %}
            <a href="?page={{ page_obj.previous_page_number }}{% if request.GET.date %}&date={{ request.GET.date }}{% endif %}" class="btn">‚Üê –ù–∞–∑–∞–¥</a>
        {% endif %}
        
        <span style="margin: 0 1rem;">
            –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ page_obj.number }} –∏–∑ {{ page_obj.paginator.num_pages }}
        </span>
        
        {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}{% if request.GET.date %}&date={{ request.GET.date }}{% endif %}" class="btn">–í–ø–µ—Ä–µ–¥ ‚Üí</a>
        {% endif %}
    </div>
    {% endif %}

{% else %}
    <div style="text-align: center; padding: 2rem;">
        <h3>üòî –ó–∞–ø–∏—Å–µ–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>
        <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞</p>
    </div>
{% endif %}

<div style="text-align: center; margin-top: 2rem;">
    <a href="{% url 'repertoire:repertoire_add' %}" class="btn">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å</a>
    <a href="{% url 'repertoire:repertoire_search' %}" class="btn">üîç –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫</a>
</div>
{% endblock %}
